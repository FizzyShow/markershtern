# Context: 
Микросервис отвечающий за аутентификацию и авторизацию пользователя
# Status
Предложено
# Decision
### Данный в БД хранятся следующим образом: 


    string id
    string login
    string hash
    string salt

> Поля user_Id и login уникальны, salt вычисляется для каждого пользователя отдельно.  

> На данном этапе в базе данных храниться какое-то количество тестовых профилей.
### Proto: 
```proto

    message LoginRequest {
        string login = 1;
        string password = 2;
    }

    message LoginResponse {

        oneof result{
             string user_Id = 1;
             Error error = 2;
        }
    }    

    enum Errors {
        LOGIN_NOT_FOUND = 0;
        WRONG_PASSWORD = 1;
    }    
```
При получении LoginRequest из кафки микросервис сравнивает вложенные данные с теми, что хранятся в БД.
* Если пользователя с указанным логином не существует, то в LoginResponse отправляем соответствующую ошибку.
* Если пользователь с указанным логином существует, то вычисляем хэш пароля с солью (которая указана в БД) и сравниваем его со значением хэша в БД:
* - Если хэш не совпадает, то в LoginResponse отправляем соответствующую ошибку.
* - Иначе в LoginResponse отправляем идентификатор пользователя (user_Id).  
> Фасад отправляет LoginRequest в топик запросов микросервиса авторизации, указывая идентификатор запроса и номер топика, в который должен записать ответ микросервис авторизации.  

> Микросервис авторизации отправляет LoginResponse в топик ответов в ту партицию, которую указал Фасад, используя полученный идентификатор запроса в качестве идентификатора ответа

Подробную информацию о взаимодействии фасада с микросервисом можно посотреть [тут](https://github.com/seesharktwo/markershtern/blob/adrCommunicationBetweenMicroServices/CommunicationBetweenMicroservices.md).